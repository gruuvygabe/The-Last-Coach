<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<title>THE LAST COACH</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#FF6B35">

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  background: linear-gradient(135deg, #FF6B35 0%, #1a1a1a 100%);
  min-height: 100vh;
  padding: 20px;
}

.container { max-width: 1200px; margin: auto; }

.card {
  background: #fff;
  border-radius: 20px;
  padding: 30px;
  margin-bottom: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

h1, h2, h3, h4 { color: #FF6B35; margin-bottom: 15px; }
h1 { font-size: 42px; }
h2 { font-size: 28px; }
h3 { font-size: 22px; }

.page { display: none; }
.page.active { display: block; }

button, .btn {
  width: 100%;
  padding: 18px;
  border: none;
  border-radius: 12px;
  background: linear-gradient(135deg, #FF6B35 0%, #1a1a1a 100%);
  color: #fff;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  transition: transform 0.2s;
  margin-top: 10px;
  min-height: 48px;
}

button:hover { transform: translateY(-2px); }
button.secondary { background: #6c757d; }
button.small { padding: 10px; font-size: 14px; width: auto; margin: 5px; }

input, select, textarea {
  width: 100%;
  padding: 15px;
  margin-top: 8px;
  border-radius: 10px;
  border: 2px solid #e0e0e0;
  font-size: 16px;
  font-family: inherit;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: #FF6B35;
}

label {
  display: block;
  margin-top: 15px;
  font-weight: 600;
  color: #333;
}

.nav {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  overflow-x: auto;
}

.nav button {
  background: rgba(255,255,255,0.9);
  color: #FF6B35;
  padding: 15px 25px;
  border-radius: 10px;
  white-space: nowrap;
  flex-shrink: 0;
  margin: 0;
}

.nav button.active {
  background: white;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.tab { display: none; }
.tab.active { display: block; }

.meal, .exercise {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 12px;
  margin-bottom: 15px;
  border-left: 4px solid #FF6B35;
}

.small { font-size: 14px; color: #666; }

.week {
  background: #ffe8df;
  padding: 20px;
  border-radius: 12px;
  margin-bottom: 25px;
  border-left: 6px solid #FF6B35;
}

.badge {
  display: inline-block;
  padding: 8px 14px;
  background: linear-gradient(135deg, #FF6B35 0%, #1a1a1a 100%);
  color: white;
  border-radius: 20px;
  margin: 0 8px 8px 0;
  font-size: 14px;
  font-weight: 600;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 15px;
  margin: 20px 0;
}

.stat-box {
  background: linear-gradient(135deg, #FF6B35 0%, #1a1a1a 100%);
  color: white;
  padding: 20px;
  border-radius: 12px;
  text-align: center;
}

.stat-box strong {
  display: block;
  font-size: 32px;
  margin-bottom: 5px;
}

.progress-bar {
  background: #e0e0e0;
  height: 10px;
  border-radius: 10px;
  overflow: hidden;
  margin: 10px 0;
}

.progress-fill {
  background: linear-gradient(90deg, #FF6B35, #ff8c42);
  height: 100%;
  transition: width 0.3s;
}

.header {
  text-align: center;
  color: white;
  margin-bottom: 30px;
}

.header h1 {
  color: white;
  font-size: 48px;
  text-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

.assessment-card {
  background: #ffe8df;
  padding: 20px;
  border-radius: 12px;
  margin: 20px 0;
  border-left: 4px solid #FF6B35;
}

.assessment-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.assessment-item {
  background: white;
  padding: 15px;
  border-radius: 10px;
}

.assessment-item strong {
  color: #FF6B35;
  display: block;
  margin-bottom: 5px;
}

.macro {
  display: inline-block;
  padding: 6px 10px;
  border-radius: 8px;
  margin-right: 8px;
  font-weight: 600;
  font-size: 13px;
}

.macro.protein { background: #ffebee; color: #c62828; }
.macro.carbs { background: #e3f2fd; color: #1565c0; }
.macro.fats { background: #f3e5f5; color: #6a1b9a; }

.grocery-section {
  background: #e3f2fd;
  padding: 20px;
  border-radius: 12px;
  margin-top: 15px;
  border-left: 4px solid #2196F3;
}

.grocery-item {
  display: flex;
  justify-content: space-between;
  padding: 10px;
  background: white;
  margin-bottom: 8px;
  border-radius: 8px;
}

.weight-entry {
  display: flex;
  justify-content: space-between;
  padding: 12px;
  background: white;
  margin-bottom: 8px;
  border-radius: 8px;
  border-left: 3px solid #FF6B35;
}

@media (max-width: 768px) {
  .card { padding: 20px; }
  .header h1 { font-size: 36px; }
  .grid { grid-template-columns: 1fr 1fr; }
}
</style>

</head>

<body>
<div class="container">

<!-- LOGIN PAGE -->

<div id="loginPage" class="page active">
  <div class="header">
    <div style="font-size: 60px; margin-bottom: 15px;">ğŸ’ª</div>
    <h1>THE LAST COACH</h1>
    <p style="color: white; font-size: 18px;">Your complete fitness transformation system</p>
  </div>

  <div class="card">
    <h2>Welcome!</h2>
    <label>Email</label>
    <input id="email" type="email" placeholder="your@email.com">
    <button onclick="login()">Start Your Journey ğŸš€</button>
  </div>
</div>

<!-- ONBOARDING PAGE -->

<div id="onboardingPage" class="page">
  <div class="header">
    <h1>ğŸ’ª Let's Build Your Plan</h1>
    <p style="color: white;">Answer a few questions to personalize everything</p>
  </div>

  <div class="progress-bar">
    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
  </div>

  <div class="card" id="onboardingCard"></div>
</div>

<!-- DASHBOARD PAGE -->

<div id="dashboardPage" class="page">
  <div class="card" style="background: white;">
    <h1 style="margin: 0;">THE LAST COACH ğŸ’ª</h1>
  </div>

  <div class="nav">
    <button class="active" onclick="switchTab('overview')">ğŸ“Š Dashboard</button>
    <button onclick="switchTab('assessment')">ğŸ“‹ Assessment</button>
    <button onclick="switchTab('nutrition')">ğŸ Meal Plan</button>
    <button onclick="switchTab('workouts')">ğŸ’ª Workouts</button>
    <button onclick="switchTab('tracking')">ğŸ“ˆ Tracking</button>
  </div>

  <div id="overview" class="tab active"></div>
  <div id="assessment" class="tab"></div>
  <div id="nutrition" class="tab"></div>
  <div id="workouts" class="tab"></div>
  <div id="tracking" class="tab"></div>
</div>

</div>

<script>
/* =============== STATE =============== */
let user = {};
let step = 0;

const save = (k, v) => localStorage.setItem(k, JSON.stringify(v));
const load = k => JSON.parse(localStorage.getItem(k) || 'null');
const today = () => new Date().toISOString().split('T')[0];

/* =============== LOGIN =============== */
function login() {
  const emailInput = document.getElementById('email');
  const email = emailInput.value.trim();
  
  if (!email) {
    alert('Please enter your email');
    return;
  }
  
  user.email = email;
  const saved = load('user_' + email);
  
  if (saved && saved.onboardingComplete) {
    user = saved;
    show('dashboardPage');
    loadDashboard();
  } else {
    show('onboardingPage');
    renderStep();
  }
}

function show(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function switchTab(id) {
  console.log('ğŸ”„ Switching to tab:', id);
  
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
  
  if (id === 'assessment') renderAssessment();
  if (id === 'nutrition') renderNutrition();
  if (id === 'workouts') renderWorkouts();
  if (id === 'tracking') renderTracking();
}

/* =============== ONBOARDING =============== */
const totalSteps = 8;

const steps = [
  // STEP 1: Basic Info
  () => `
    <h2>Step 1: Basic Information</h2>
    <label>First Name</label>
    <input id="name" placeholder="Enter your name" value="${user.name || ''}">
    
    <label>Age</label>
    <input id="age" type="number" placeholder="25" value="${user.age || ''}">
    
    <label>Gender</label>
    <select id="gender">
      <option value="male" ${user.gender === 'male' ? 'selected' : ''}>Male</option>
      <option value="female" ${user.gender === 'female' ? 'selected' : ''}>Female</option>
    </select>
    
    <label>Height</label>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
      <input id="heightFeet" type="number" placeholder="5" value="${user.heightFeet || ''}" min="3" max="8">
      <input id="heightInches" type="number" placeholder="10" value="${user.heightInches || ''}" min="0" max="11">
    </div>
    <p class="small">Feet and inches</p>
    
    <button onclick="next(() => {
      user.name = name.value;
      user.age = +age.value;
      user.gender = gender.value;
      user.heightFeet = +heightFeet.value;
      user.heightInches = +heightInches.value;
      user.height = (user.heightFeet * 12) + user.heightInches;
    })">Continue</button>
  `,
  
  // STEP 2: Current Fitness
  () => `
    <h2>Step 2: Current Fitness</h2>
    <label>Current Weight (lbs)</label>
    <input id="weight" type="number" placeholder="180" value="${user.weight || ''}" step="0.1">
    
    <label>Activity Level</label>
    <select id="activityLevel">
      <option value="sedentary">Sedentary (little to no exercise)</option>
      <option value="light">Lightly Active (1-3 days/week)</option>
      <option value="moderate" selected>Moderately Active (3-5 days/week)</option>
      <option value="very">Very Active (6-7 days/week)</option>
      <option value="extreme">Extremely Active (athlete)</option>
    </select>
    
    <button onclick="next(() => {
      user.weight = +weight.value;
      user.activityLevel = activityLevel.value;
    })">Continue</button>
    <button class="secondary" onclick="prev()">Back</button>
  `,
  
  // STEP 3: Goals
  () => `
    <h2>Step 3: Your Goals</h2>
    <label>Primary Goal</label>
    <select id="primaryGoal">
      <option value="weight-loss">ğŸ”¥ Weight Loss</option>
      <option value="muscle-gain">ğŸ’ª Muscle Gain</option>
      <option value="maintenance">âš–ï¸ Maintain Weight</option>
      <option value="athletic">ğŸƒ Athletic Performance</option>
    </select>
    
    <label>Goal Weight (lbs)</label>
    <input id="goalWeight" type="number" placeholder="170" value="${user.goalWeight || ''}" step="0.1">
    
    <label>Timeline</label>
    <select id="timeline">
      <option value="3months">3 Months</option>
      <option value="6months" selected>6 Months</option>
      <option value="1year">1 Year</option>
      <option value="ongoing">Ongoing Journey</option>
    </select>
    
    <button onclick="next(() => {
      user.primaryGoal = primaryGoal.value;
      user.goalWeight = +goalWeight.value;
      user.timeline = timeline.value;
      user.goal = user.primaryGoal === 'weight-loss' ? 'cut' : user.primaryGoal === 'muscle-gain' ? 'bulk' : 'maintain';
    })">Continue</button>
    <button class="secondary" onclick="prev()">Back</button>
  `,
  
  // STEP 4: Workout Preferences
  () => `
    <h2>Step 4: Workout Preferences</h2>
    <label>Training Days Per Week</label>
    <input type="range" min="2" max="6" value="${user.workoutDays || 4}" id="workoutDays" 
           oninput="wdDisplay.innerText = workoutDays.value + ' days/week'">
    <div id="wdDisplay" style="text-align: center; font-size: 24px; font-weight: bold; color: #FF6B35; margin: 15px 0;">
      ${user.workoutDays || 4} days/week
    </div>
    
    <label>Workout Duration (minutes per session)</label>
    <select id="workoutDuration">
      <option value="30">30 minutes</option>
      <option value="45" selected>45 minutes</option>
      <option value="60">60 minutes</option>
      <option value="90">90 minutes</option>
    </select>
    
    <label>Workout Location (select all that apply)</label>
    <select id="workoutLocations" multiple size="3" style="height: auto;">
      <option value="home">ğŸ  Home</option>
      <option value="gym">ğŸ‹ï¸ Gym</option>
      <option value="outdoor">ğŸŒ³ Outdoor</option>
    </select>
    
    <label>Available Equipment</label>
    <select id="equipment" multiple size="5" style="height: auto;">
      <option value="bodyweight">ğŸ¤¸ Bodyweight Only</option>
      <option value="dumbbells">ğŸ‹ï¸ Dumbbells</option>
      <option value="barbells">ğŸ’ª Barbells</option>
      <option value="bands">ğŸ€ Resistance Bands</option>
      <option value="gym">ğŸ¢ Full Gym Access</option>
    </select>
    <p class="small">Hold Ctrl/Cmd to select multiple</p>
    
    <button onclick="next(() => {
      user.workoutDays = +workoutDays.value;
      user.days = user.workoutDays;
      user.workoutDuration = +workoutDuration.value;
      const locSelect = document.getElementById('workoutLocations');
      user.workoutLocations = [...locSelect.selectedOptions].map(o => o.value);
      const eqSelect = document.getElementById('equipment');
      user.equipment = [...eqSelect.selectedOptions].map(o => o.value);
    })">Continue</button>
    <button class="secondary" onclick="prev()">Back</button>
  `,
  
  // STEP 5: Nutrition Preferences
  () => `
    <h2>Step 5: Nutrition Preferences</h2>
    <label>Dietary Type</label>
    <select id="dietType" multiple size="5" style="height: auto;">
      <option value="none" selected>No Restrictions</option>
      <option value="vegetarian">ğŸ¥— Vegetarian</option>
      <option value="vegan">ğŸŒ± Vegan</option>
      <option value="keto">ğŸ¥‘ Keto</option>
      <option value="paleo">ğŸ¥© Paleo</option>
    </select>
    
    <label>Meals Per Day</label>
    <select id="mealsPerDay">
      <option value="2">2 meals</option>
      <option value="3" selected>3 meals</option>
      <option value="4">4 meals</option>
      <option value="5">5 meals</option>
    </select>
    
    <label>Food Allergies / Restrictions (optional)</label>
    <textarea id="allergies" rows="3" placeholder="e.g., nuts, dairy, gluten">${user.allergies || ''}</textarea>

```
<button onclick="next(() => {
  const dietSelect = document.getElementById('dietType');
  user.diet = [...dietSelect.selectedOptions].map(o => o.value);
  user.mealsPerDay = +mealsPerDay.value;
  user.allergies = allergies.value;
})">Continue</button>
<button class="secondary" onclick="prev()">Back</button>
```

`,

// STEP 6: Lifestyle & Schedule
() => `
<h2>Step 6: Lifestyle & Schedule</h2>
<label>Work Schedule</label>
<select id="workSchedule">
<option value="9-5">9 AM - 5 PM</option>
<option value="flexible">Flexible Hours</option>
<option value="night">Night Shift</option>
<option value="irregular">Irregular Schedule</option>
</select>

```
<label>Preferred Workout Times</label>
<select id="workoutTimes" multiple size="4" style="height: auto;">
  <option value="early-morning">ğŸŒ… Early Morning (5-7 AM)</option>
  <option value="morning">â˜€ï¸ Morning (7-10 AM)</option>
  <option value="afternoon">ğŸŒ¤ï¸ Afternoon (12-3 PM)</option>
  <option value="evening">ğŸŒ† Evening (5-8 PM)</option>
</select>

<label>Average Sleep (hours per night)</label>
<input id="sleepHours" type="number" min="4" max="12" value="${user.sleepHours || 7}" step="0.5">

<button onclick="next(() => {
  user.workSchedule = workSchedule.value;
  const wtSelect = document.getElementById('workoutTimes');
  user.workoutTimes = [...wtSelect.selectedOptions].map(o => o.value);
  user.sleepHours = +sleepHours.value;
})">Continue</button>
<button class="secondary" onclick="prev()">Back</button>
```

`,

// STEP 7: Motivation & Mindset
() => `
<h2>Step 7: Motivation & Mindset</h2>
<label>What motivates you most?</label>
<textarea id="motivation" rows="4" placeholder="Tell us what drives you to reach your fitness goals...">${user.motivation || â€˜â€™}</textarea>

```
<label>Biggest Barriers to Success</label>
<select id="barriers" multiple size="4" style="height: auto;">
  <option value="time">â° Lack of Time</option>
  <option value="motivation">ğŸ˜´ Low Motivation</option>
  <option value="knowledge">ğŸ“š Not Sure What to Do</option>
  <option value="accountability">ğŸ‘¥ Need Accountability</option>
</select>

<label>Learning Style</label>
<select id="learningStyle">
  <option value="visual">ğŸ‘ï¸ Visual (videos, images)</option>
  <option value="reading">ğŸ“– Reading (written instructions)</option>
  <option value="doing">ğŸ¤¸ Hands-on (learn by doing)</option>
</select>

<button onclick="next(() => {
  user.motivation = motivation.value;
  const barSelect = document.getElementById('barriers');
  user.barriers = [...barSelect.selectedOptions].map(o => o.value);
  user.learningStyle = learningStyle.value;
})">Continue</button>
<button class="secondary" onclick="prev()">Back</button>
```

`,

// STEP 8: Medical & Final
() => `
<h2>Step 8: Medical & Final Details</h2>
<label>Any Injuries or Physical Limitations?</label>
<textarea id="injuries" rows="3" placeholder="e.g., knee issues, back pain, etc.">${user.injuries || â€˜â€™}</textarea>

```
<label>Medical Conditions (optional)</label>
<textarea id="medicalConditions" rows="3" placeholder="e.g., diabetes, heart conditions, etc.">${user.medicalConditions || ''}</textarea>

<label>Additional Notes</label>
<textarea id="additionalNotes" rows="3" placeholder="Anything else we should know?">${user.additionalNotes || ''}</textarea>

<label>
  <input type="checkbox" id="termsAgree" style="width: auto; margin-right: 10px;">
  I understand this is for informational purposes only and not medical advice
</label>

<button onclick="if(termsAgree.checked) finish(); else alert('Please agree to terms');">
  Complete Setup ğŸ‰
</button>
<button class="secondary" onclick="prev()">Back</button>
```

`
];

function renderStep() {
document.getElementById(â€˜progressFillâ€™).style.width = ((step / totalSteps) * 100) + â€˜%â€™;
document.getElementById(â€˜onboardingCardâ€™).innerHTML = steps[step]();
}

function next(fn) {
if (fn) fn();
step++;
if (step >= steps.length) finish();
else renderStep();
}

function prev() {
stepâ€“;
if (step < 0) step = 0;
renderStep();
}

/* =============== CALCULATIONS =============== */
function finish() {
// Collect final step data
user.injuries = document.getElementById(â€˜injuriesâ€™).value;
user.medicalConditions = document.getElementById(â€˜medicalConditionsâ€™).value;
user.additionalNotes = document.getElementById(â€˜additionalNotesâ€™).value;

console.log(â€˜ğŸ“‹ Complete user data:â€™, user);

// Calculate activity multiplier
const activityMultipliers = {
â€˜sedentaryâ€™: 1.2,
â€˜lightâ€™: 1.375,
â€˜moderateâ€™: 1.55,
â€˜veryâ€™: 1.725,
â€˜extremeâ€™: 1.9
};

const activityMult = activityMultipliers[user.activityLevel] || 1.55;

// BMR calculation (Mifflin-St Jeor)
const kg = user.weight * 0.453592;
const cm = user.height * 2.54;
const bmr = user.gender === â€œmaleâ€
? 10 * kg + 6.25 * cm - 5 * user.age + 5
: 10 * kg + 6.25 * cm - 5 * user.age - 161;

user.bmr = Math.round(bmr);
user.tdee = Math.round(bmr * activityMult);

// Calculate calorie target based on goal
user.calories = user.goal === â€œcutâ€
? user.tdee - 500
: user.goal === â€œbulkâ€
? user.tdee + 300
: user.tdee;

// Macro calculations
const macroRatios = {
cut: {p: 0.40, c: 0.30, f: 0.30},
maintain: {p: 0.30, c: 0.40, f: 0.30},
bulk: {p: 0.30, c: 0.50, f: 0.20}
};

const ratio = macroRatios[user.goal] || macroRatios.maintain;

user.macros = {
protein: Math.round((user.calories * ratio.p) / 4),
carbs: Math.round((user.calories * ratio.c) / 4),
fats: Math.round((user.calories * ratio.f) / 9)
};

user.startDate = today();
user.onboardingComplete = true;
user.createdAt = new Date().toISOString();

save(â€˜user_â€™ + user.email, user);
console.log(â€˜âœ… User data saved:â€™, user);

const mealPlan = generateMealPlan();
console.log(â€˜âœ… Meal plan generated:â€™, mealPlan);

generateWorkoutPlan();
console.log(â€˜âœ… Workout plan generatedâ€™);

show(â€˜dashboardPageâ€™);
loadDashboard();
}

/* =============== DASHBOARD =============== */
function getSplit() {
if (user.days <= 3) return â€œFull Bodyâ€;
if (user.days === 4) return â€œUpper/Lowerâ€;
return â€œPush/Pull/Legsâ€;
}

function loadDashboard() {
const water = load(â€œwaterâ€)?.[today()] || 0;
const currentWeight = latestWeight() || user.weight;
const weightToGo = Math.abs(user.weight - user.goalWeight).toFixed(1);

overview.innerHTML = `
<div class="card">
<h2>Welcome back, ${user.name}! ğŸ‘‹</h2>
<div>
<span class="badge">Started ${new Date(user.startDate).toLocaleDateString()}</span>
<span class="badge">${user.goal.toUpperCase()}</span>
<span class="badge">${getSplit()}</span>
</div>
</div>

```
<div class="grid">
  <div class="stat-box"><strong>${user.calories}</strong><span>Calories</span></div>
  <div class="stat-box"><strong>${user.macros.protein}g</strong><span>Protein</span></div>
  <div class="stat-box"><strong>${user.macros.carbs}g</strong><span>Carbs</span></div>
  <div class="stat-box"><strong>${user.macros.fats}g</strong><span>Fats</span></div>
</div>

<div class="card">
  <h3>ğŸ’§ Water</h3>
  <div style="display: flex; justify-content: space-between; align-items: center;">
    <span style="font-size: 32px; font-weight: bold; color: #FF6B35;" id="water">${water}</span>
    <span>oz today</span>
  </div>
  <button class="small secondary" onclick="addWater(8)">+8 oz</button>
</div>

<div class="card">
  <h3>âš–ï¸ Weight</h3>
  <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: end;">
    <input id="weightInput" type="number" step="0.1" placeholder="${currentWeight}">
    <button class="small" onclick="logWeight()" style="width: auto;">Log</button>
  </div>
  <div style="margin-top: 15px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">
    <div><strong class="small">Current</strong><div style="font-size: 24px; color: #FF6B35;">${currentWeight}</div></div>
    <div><strong class="small">Goal</strong><div style="font-size: 24px; color: #FF6B35;">${user.goalWeight}</div></div>
    <div><strong class="small">To Go</strong><div style="font-size: 24px; color: #FF6B35;">${weightToGo}</div></div>
  </div>
</div>
```

`;
}

function addWater(oz) {
const w = load(â€œwaterâ€) || {};
w[today()] = (w[today()] || 0) + oz;
save(â€œwaterâ€, w);
document.getElementById(â€œwaterâ€).innerText = w[today()];
}

function logWeight() {
const v = +document.getElementById(â€˜weightInputâ€™).value;
if (!v) return alert(â€˜Enter weightâ€™);
const w = load(â€œweightsâ€) || {};
w[today()] = v;
save(â€œweightsâ€, w);
loadDashboard();
}

function latestWeight() {
const w = load(â€œweightsâ€) || {};
const dates = Object.keys(w).sort();
return dates.length ? w[dates[dates.length - 1]] : null;
}

/* =============== ASSESSMENT =============== */
function renderAssessment() {
assessment.innerHTML = `
<div class="card">
<h2>ğŸ“‹ Complete Assessment</h2>
<p class="small">Your personalized fitness profile from 8-step onboarding</p>
</div>

```
<div class="assessment-card">
  <h3>ğŸ‘¤ Personal Information</h3>
  <div class="assessment-grid">
    <div class="assessment-item"><strong>Name</strong>${user.name}</div>
    <div class="assessment-item"><strong>Age</strong>${user.age} years</div>
    <div class="assessment-item"><strong>Gender</strong>${user.gender}</div>
    <div class="assessment-item"><strong>Height</strong>${user.heightFeet}'${user.heightInches}"</div>
  </div>
</div>

<div class="assessment-card">
  <h3>ğŸ’ª Current Fitness</h3>
  <div class="assessment-grid">
    <div class="assessment-item"><strong>Current Weight</strong>${user.weight} lbs</div>
    <div class="assessment-item"><strong>Activity Level</strong>${user.activityLevel}</div>
    <div class="assessment-item"><strong>BMR</strong>${user.bmr || '--'} kcal</div>
    <div class="assessment-item"><strong>TDEE</strong>${user.tdee} kcal</div>
  </div>
</div>

<div class="assessment-card">
  <h3>ğŸ¯ Goals & Timeline</h3>
  <div class="assessment-grid">
    <div class="assessment-item"><strong>Primary Goal</strong>${user.primaryGoal}</div>
    <div class="assessment-item"><strong>Goal Weight</strong>${user.goalWeight} lbs</div>
    <div class="assessment-item"><strong>To Lose/Gain</strong>${Math.abs(user.weight - user.goalWeight).toFixed(1)} lbs</div>
    <div class="assessment-item"><strong>Timeline</strong>${user.timeline}</div>
  </div>
</div>

<div class="assessment-card">
  <h3>ğŸ‹ï¸ Workout Plan</h3>
  <div class="assessment-grid">
    <div class="assessment-item"><strong>Days/Week</strong>${user.workoutDays} days</div>
    <div class="assessment-item"><strong>Duration</strong>${user.workoutDuration} min/session</div>
    <div class="assessment-item"><strong>Split</strong>${getSplit()}</div>
    <div class="assessment-item"><strong>Locations</strong>${user.workoutLocations ? user.workoutLocations.join(', ') : 'N/A'}</div>
  </div>
  <div style="margin-top: 15px;">
    <strong style="color: #FF6B35;">Equipment:</strong> ${user.equipment.join(', ')}
  </div>
</div>

<div class="assessment-card">
  <h3>ğŸ Nutrition Plan</h3>
  <div class="assessment-grid">
    <div class="assessment-item"><strong>Daily Calories</strong>${user.calories} kcal</div>
    <div class="assessment-item"><strong>Protein</strong>${user.macros.protein}g (${Math.round((user.macros.protein * 4 / user.calories) * 100)}%)</div>
    <div class="assessment-item"><strong>Carbs</strong>${user.macros.carbs}g (${Math.round((user.macros.carbs * 4 / user.calories) * 100)}%)</div>
    <div class="assessment-item"><strong>Fats</strong>${user.macros.fats}g (${Math.round((user.macros.fats * 9 / user.calories) * 100)}%)</div>
    <div class="assessment-item"><strong>Diet Type</strong>${user.diet.join(', ')}</div>
    <div class="assessment-item"><strong>Meals/Day</strong>${user.mealsPerDay}</div>
  </div>
  ${user.allergies ? `<div style="margin-top: 15px;"><strong style="color: #FF6B35;">Allergies:</strong> ${user.allergies}</div>` : ''}
</div>

<div class="assessment-card">
  <h3>â° Lifestyle & Schedule</h3>
  <div class="assessment-grid">
    <div class="assessment-item"><strong>Work Schedule</strong>${user.workSchedule}</div>
    <div class="assessment-item"><strong>Sleep</strong>${user.sleepHours} hours/night</div>
    <div class="assessment-item"><strong>Learning Style</strong>${user.learningStyle || 'N/A'}</div>
  </div>
  <div style="margin-top: 15px;">
    <strong style="color: #FF6B35;">Preferred Workout Times:</strong> ${user.workoutTimes ? user.workoutTimes.join(', ') : 'N/A'}
  </div>
  ${user.barriers ? `<div style="margin-top: 10px;"><strong style="color: #FF6B35;">Barriers:</strong> ${user.barriers.join(', ')}</div>` : ''}
</div>

<div class="assessment-card">
  <h3>ğŸ’­ Motivation & Health</h3>
  ${user.motivation ? `<div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;"><strong>Motivation:</strong><br>${user.motivation}</div>` : ''}
  ${user.injuries ? `<div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;"><strong>Injuries/Limitations:</strong><br>${user.injuries}</div>` : ''}
  ${user.medicalConditions ? `<div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;"><strong>Medical Conditions:</strong><br>${user.medicalConditions}</div>` : ''}
  ${user.additionalNotes ? `<div style="background: white; padding: 15px; border-radius: 8px;"><strong>Additional Notes:</strong><br>${user.additionalNotes}</div>` : ''}
</div>
```

`;
}

/* =============== FOOD & RECIPES =============== */
const FOODS = [
{n:â€œEgg Whitesâ€,p:11,c:2,f:0,u:â€œcupâ€},
{n:â€œChicken Breastâ€,p:31,c:0,f:3,u:â€œ4ozâ€},
{n:â€œLean Turkeyâ€,p:22,c:0,f:8,u:â€œ4ozâ€},
{n:â€œSalmonâ€,p:22,c:0,f:12,u:â€œ4ozâ€},
{n:â€œGreek Yogurtâ€,p:17,c:6,f:0,u:â€œcupâ€},
{n:â€œBrown Riceâ€,p:5,c:45,f:2,u:â€œcupâ€},
{n:â€œOatsâ€,p:10,c:54,f:6,u:â€œcupâ€},
{n:â€œSweet Potatoâ€,p:4,c:41,f:0,u:â€œmediumâ€},
{n:â€œBroccoliâ€,p:4,c:11,f:0,u:â€œcupâ€},
{n:â€œSpinachâ€,p:2,c:4,f:0,u:â€œcupâ€},
{n:â€œAvocadoâ€,p:3,c:12,f:21,u:â€œwholeâ€},
{n:â€œOlive Oilâ€,p:0,c:0,f:14,u:â€œtbspâ€},
{n:â€œBananaâ€,p:1,c:27,f:0,u:â€œmediumâ€},
{n:â€œWhey Proteinâ€,p:24,c:3,f:1,u:â€œscoopâ€}
];

const food = n => FOODS.find(f => f.n === n);

const RECIPES = [
{
id:â€œegg_scrambleâ€, meal:â€œbreakfastâ€, goal:[â€œcutâ€,â€œmaintainâ€],
name:â€œEgg White Scrambleâ€,
ingredients:[{food:â€œEgg Whitesâ€,s:1.5},{food:â€œSpinachâ€,s:1},{food:â€œOlive Oilâ€,s:0.25}],
steps:[â€œHeat oilâ€,â€œCook eggsâ€,â€œAdd spinachâ€]
},
{
id:â€œyogurt_bowlâ€, meal:â€œbreakfastâ€, goal:[â€œmaintainâ€,â€œbulkâ€],
name:â€œGreek Yogurt Bowlâ€,
ingredients:[{food:â€œGreek Yogurtâ€,s:1.5},{food:â€œBananaâ€,s:1}],
steps:[â€œLayer yogurtâ€,â€œTop with bananaâ€]
},
{
id:â€œchicken_riceâ€, meal:â€œlunchâ€, goal:[â€œcutâ€,â€œmaintainâ€,â€œbulkâ€],
name:â€œChicken & Riceâ€,
ingredients:[{food:â€œChicken Breastâ€,s:1.5},{food:â€œBrown Riceâ€,s:1},{food:â€œBroccoliâ€,s:1}],
steps:[â€œGrill chickenâ€,â€œCook riceâ€,â€œSteam broccoliâ€,â€œCombineâ€]
},
{
id:â€œturkey_potatoâ€, meal:â€œdinnerâ€, goal:[â€œcutâ€,â€œmaintainâ€,â€œbulkâ€],
name:â€œTurkey & Sweet Potatoâ€,
ingredients:[{food:â€œLean Turkeyâ€,s:1.5},{food:â€œSweet Potatoâ€,s:2},{food:â€œSpinachâ€,s:1}],
steps:[â€œBrown turkeyâ€,â€œRoast potatoâ€,â€œSautÃ© spinachâ€]
},
{
id:â€œsalmon_vegâ€, meal:â€œdinnerâ€, goal:[â€œmaintainâ€,â€œbulkâ€],
name:â€œSalmon & Veggiesâ€,
ingredients:[{food:â€œSalmonâ€,s:1.5},{food:â€œBroccoliâ€,s:1.5},{food:â€œOlive Oilâ€,s:0.5}],
steps:[â€œBake salmonâ€,â€œSteam broccoliâ€,â€œDrizzle oilâ€]
}
];

function macros(recipe) {
return recipe.ingredients.reduce((t, i) => {
const f = food(i.food);
t.p += f.p * i.s;
t.c += f.c * i.s;
t.f += f.f * i.s;
return t;
}, {p:0, c:0, f:0});
}

function generateMealPlan() {
const feedback = load(â€œfeedbackâ€) || {};
const pool = RECIPES.filter(r => r.goal.includes(user.goal) && feedback[r.id] !== â€œdislikeâ€);

const plan = [];
for (let w = 0; w < 4; w++) {
const week = [];
for (let d = 0; d < 7; d++) {
const day = {};
[â€œbreakfastâ€, â€œlunchâ€, â€œdinnerâ€].forEach(meal => {
const opts = pool.filter(r => r.meal === meal);
if (opts.length > 0) day[meal] = opts[Math.floor(Math.random() * opts.length)];
});
week.push(day);
}
plan.push(week);
}

save(â€œmealPlanâ€, plan);
return plan;
}

function rate(id, val) {
const f = load(â€œfeedbackâ€) || {};
f[id] = val;
save(â€œfeedbackâ€, f);
generateMealPlan();
renderNutrition();
}

function grocery(week) {
const g = {};
week.forEach(day => {
Object.values(day).forEach(recipe => {
if (recipe) recipe.ingredients.forEach(i => g[i.food] = (g[i.food] || 0) + i.s);
});
});
return g;
}

function renderNutrition() {
console.log(â€˜ğŸ“‹ Rendering nutrition, user:â€™, user);

let plan = load(â€œmealPlanâ€);
console.log(â€˜ğŸ“‹ Loaded meal plan:â€™, plan);

if (!plan) {
console.log(â€˜ğŸ“‹ No meal plan found, generatingâ€¦â€™);
plan = generateMealPlan();
}

if (!plan || plan.length === 0) {
nutrition.innerHTML = â€˜<div class="card"><h2>âš ï¸ No meal plan generated</h2><p>Please complete onboarding first.</p></div>â€™;
return;
}

nutrition.innerHTML = `<div class="card"> <h2>ğŸ 28-Day Meal Plan</h2> <p class="small">Personalized for ${user.goal} â€¢ ${user.calories} cal/day</p> </div>`;

plan.forEach((week, i) => {
nutrition.innerHTML += `<div class="week"><h3>Week ${i + 1}</h3>`;

```
week.forEach((day, d) => {
  nutrition.innerHTML += `<h4 style="margin-top: 20px; color: #333;">Day ${d + 1}</h4>`;
  
  Object.values(day).forEach(recipe => {
    if (!recipe) return;
    const m = macros(recipe);
    const cals = Math.round(m.p * 4 + m.c * 4 + m.f * 9);
    
    nutrition.innerHTML += `
      <div class="meal">
        <div style="display: flex; justify-content: space-between;">
          <strong style="font-size: 18px;">${recipe.name}</strong>
          <strong>${cals} cal</strong>
        </div>
        <div style="margin: 10px 0;">
          <span class="macro protein">${Math.round(m.p)}P</span>
          <span class="macro carbs">${Math.round(m.c)}C</span>
          <span class="macro fats">${Math.round(m.f)}F</span>
        </div>
        <p class="small">${recipe.steps.join(" â†’ ")}</p>
        <button class="small" onclick="rate('${recipe.id}','like')">ğŸ‘</button>
        <button class="small secondary" onclick="rate('${recipe.id}','dislike')">ğŸ‘</button>
      </div>
    `;
  });
});

const g = grocery(week);
nutrition.innerHTML += `
  <div class="grocery-section">
    <h4>ğŸ›’ Grocery List</h4>
    ${Object.keys(g).map(k => `
      <div class="grocery-item">
        <span>${k}</span>
        <strong>${g[k].toFixed(1)} ${food(k).u}</strong>
      </div>
    `).join('')}
  </div>
`;

nutrition.innerHTML += `</div>`;
```

});
}

/* =============== WORKOUTS =============== */
const EXERCISES = {
fullbody: [â€œSquatâ€, â€œBench Pressâ€, â€œDeadliftâ€, â€œOverhead Pressâ€, â€œRowâ€],
upper: [â€œBench Pressâ€, â€œRowâ€, â€œOverhead Pressâ€, â€œPull-Upsâ€, â€œDipsâ€],
lower: [â€œSquatâ€, â€œDeadliftâ€, â€œLeg Pressâ€, â€œLeg Curlâ€, â€œCalf Raisesâ€],
push: [â€œBench Pressâ€, â€œIncline Pressâ€, â€œOverhead Pressâ€, â€œTricep Dipsâ€],
pull: [â€œDeadliftâ€, â€œPull-Upsâ€, â€œBarbell Rowâ€, â€œFace Pullsâ€, â€œCurlsâ€],
legs: [â€œSquatâ€, â€œLeg Pressâ€, â€œLeg Curlâ€, â€œCalf Raisesâ€, â€œLungesâ€]
};

function generateWorkoutPlan() {
let program = {};

if (user.days <= 3) {
program = {
â€œDay Aâ€: EXERCISES.fullbody,
â€œDay Bâ€: EXERCISES.fullbody.reverse()
};
} else if (user.days === 4) {
program = {
â€œUpperâ€: EXERCISES.upper,
â€œLowerâ€: EXERCISES.lower
};
} else {
program = {
â€œPushâ€: EXERCISES.push,
â€œPullâ€: EXERCISES.pull,
â€œLegsâ€: EXERCISES.legs
};
}

save(â€œworkoutProgramâ€, program);
}

function renderWorkouts() {
console.log(â€˜ğŸ’ª Rendering workouts, user:â€™, user);

let program = load(â€œworkoutProgramâ€);
console.log(â€˜ğŸ’ª Loaded workout program:â€™, program);

if (!program || Object.keys(program).length === 0) {
console.log(â€˜ğŸ’ª No workout program found, generatingâ€¦â€™);
generateWorkoutPlan();
program = load(â€œworkoutProgramâ€);
}

const logs = load(â€œworkoutLogsâ€) || {};

workouts.innerHTML = `<div class="card"> <h2>ğŸ’ª ${getSplit()} Training</h2> <p class="small">${user.days} days/week</p> </div>`;

Object.keys(program).forEach(day => {
workouts.innerHTML += `<div class="week"><h3>${day}</h3>`;

```
program[day].forEach(ex => {
  const history = logs[ex] || [];
  const last = history[history.length - 1];
  
  workouts.innerHTML += `
    <div class="exercise">
      <div style="display: flex; justify-content: space-between;">
        <strong style="font-size: 18px;">${ex}</strong>
        ${last ? `<span class="small">Last: ${last.weight} lbs Ã— ${last.reps}</span>` : ''}
      </div>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
        <input id="${day}_${ex}_w" type="number" placeholder="Weight">
        <input id="${day}_${ex}_r" type="number" placeholder="Reps">
      </div>
      <button class="small" onclick="logSet('${ex}','${day}')">Log Set</button>
    </div>
  `;
});

workouts.innerHTML += `</div>`;
```

});
}

function logSet(ex, day) {
const w = document.getElementById(`${day}_${ex}_w`).value;
const r = document.getElementById(`${day}_${ex}_r`).value;
if (!w || !r) return alert(â€˜Enter weight and repsâ€™);

const logs = load(â€œworkoutLogsâ€) || {};
logs[ex] = logs[ex] || [];
logs[ex].push({date: today(), weight: w, reps: r});
save(â€œworkoutLogsâ€, logs);
renderWorkouts();
}

/* =============== TRACKING =============== */
function renderTracking() {
const weights = load(â€œweightsâ€) || {};
const water = load(â€œwaterâ€) || {};

const weightEntries = Object.entries(weights).sort().reverse().slice(0, 10);
const waterEntries = Object.entries(water).sort().reverse().slice(0, 7);

tracking.innerHTML = `
<div class="card">
<h2>ğŸ“ˆ Progress Tracking</h2>
</div>

```
<div class="week">
  <h3>âš–ï¸ Weight History</h3>
  ${weightEntries.length > 0 ? weightEntries.map(([date, weight]) => `
    <div class="weight-entry">
      <span>${date}</span>
      <strong style="color: #FF6B35;">${weight} lbs</strong>
    </div>
  `).join('') : '<p class="small">No weight logs yet</p>'}
</div>

<div class="week">
  <h3>ğŸ’§ Water Intake</h3>
  ${waterEntries.length > 0 ? waterEntries.map(([date, oz]) => `
    <div style="background: white; padding: 12px; margin-bottom: 8px; border-radius: 8px;">
      <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <span>${date}</span>
        <strong style="color: #FF6B35;">${oz} oz</strong>
      </div>
      <div class="progress-bar" style="margin: 0;">
        <div class="progress-fill" style="width: ${Math.min(oz, 100)}%"></div>
      </div>
    </div>
  `).join('') : '<p class="small">No water logs yet</p>'}
</div>
```

`;
}

/* =============== INIT =============== */
window.onload = function() {
const lastEmail = load(â€˜lastEmailâ€™);
if (lastEmail) {
const savedUser = load(â€˜user_â€™ + lastEmail);
if (savedUser && savedUser.onboardingComplete) {
document.getElementById(â€˜emailâ€™).value = lastEmail;
user = savedUser;
show(â€˜dashboardPageâ€™);
loadDashboard();
}
}
};

window.addEventListener(â€˜beforeunloadâ€™, () => {
if (user.email) save(â€˜lastEmailâ€™, user.email);
});
</script>

</body>
</html>
